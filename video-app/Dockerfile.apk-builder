# =============================================================================
# è§†é¢‘åº”ç”¨ - Docker APK æ„å»ºé•œåƒ
# APK Builder - Android APK æ‰“åŒ…ç¯å¢ƒ
# =============================================================================
# ä½¿ç”¨æ–¹æ³•:
#   docker build -f Dockerfile.apk-builder -t video-app-apk-builder .
#   docker run -v $(pwd):/app/source:ro -v $(pwd)/output:/app/output video-app-apk-builder [debug|release]
#
# æ³¨æ„: æºä»£ç é€šè¿‡å·æŒ‚è½½ä¼ å…¥ï¼Œç¡®ä¿æ¯æ¬¡æ„å»ºéƒ½ä½¿ç”¨æœ€æ–°ä»£ç 
# =============================================================================

FROM ubuntu:24.04

# è®¾ç½® Shell é€‰é¡¹ä»¥ä¾¿æ›´å¥½åœ°å¤„ç†ç®¡é“é”™è¯¯
SHELL ["/bin/bash", "-o", "pipefail", "-c"]

# é¿å…äº¤äº’å¼æç¤º
ENV DEBIAN_FRONTEND=noninteractive

# è®¾ç½® Android SDK ç¯å¢ƒå˜é‡
ENV ANDROID_HOME=/opt/android-sdk
ENV ANDROID_SDK_ROOT=/opt/android-sdk
ENV PATH="${PATH}:${ANDROID_HOME}/cmdline-tools/latest/bin:${ANDROID_HOME}/platform-tools:${ANDROID_HOME}/build-tools/35.0.0"

# è®¾ç½® Java ç¯å¢ƒå˜é‡
ENV JAVA_HOME=/usr/lib/jvm/java-21-openjdk-amd64

# è®¾ç½®æ—¶åŒº
ENV TZ=Asia/Shanghai
RUN ln -snf /usr/share/zoneinfo/$TZ /etc/localtime && echo $TZ > /etc/timezone

# =============================================================================
# å®‰è£…åŸºç¡€ä¾èµ–
# =============================================================================
RUN apt-get update && apt-get install -y --no-install-recommends \
    # åŸºç¡€å·¥å…·
    curl \
    wget \
    unzip \
    git \
    rsync \
    ca-certificates \
    gnupg \
    # Java JDK 21 (required by Capacitor Android)
    openjdk-21-jdk \
    # æ„å»ºå·¥å…·
    build-essential \
    # 32ä½åº“æ”¯æŒ (Android SDKéœ€è¦)
    lib32stdc++6 \
    lib32z1 \
    # æ¸…ç†ç¼“å­˜
    && apt-get clean \
    && rm -rf /var/lib/apt/lists/*

# =============================================================================
# å®‰è£… Node.js 20.x LTS
# =============================================================================
RUN curl -fsSL https://deb.nodesource.com/setup_20.x | bash - \
    && apt-get install -y --no-install-recommends nodejs \
    && apt-get clean \
    && rm -rf /var/lib/apt/lists/* \
    && npm install -g npm@latest

# =============================================================================
# å®‰è£… Android SDK å‘½ä»¤è¡Œå·¥å…·
# =============================================================================
# ä½¿ç”¨æœ€æ–°ç¨³å®šç‰ˆæœ¬çš„å‘½ä»¤è¡Œå·¥å…·
ARG CMDLINE_TOOLS_VERSION=11076708
ARG BUILD_TOOLS_VERSION=35.0.0
ARG PLATFORM_VERSION=android-35
ARG KOTLIN_VERSION=1.8.22

WORKDIR ${ANDROID_HOME}/cmdline-tools
RUN wget -q https://dl.google.com/android/repository/commandlinetools-linux-${CMDLINE_TOOLS_VERSION}_latest.zip -O cmdline-tools.zip \
    && unzip -q cmdline-tools.zip \
    && rm cmdline-tools.zip \
    && mv cmdline-tools latest

# æ¥å— Android SDK è®¸å¯åè®®
# æ³¨æ„: æŸäº›è®¸å¯å¯èƒ½è¿”å›éé›¶é€€å‡ºç ï¼Œè¿™æ˜¯æ­£å¸¸çš„
RUN yes | ${ANDROID_HOME}/cmdline-tools/latest/bin/sdkmanager --licenses 2>&1 | tee /tmp/license-output.log || true \
    && echo "SDK è®¸å¯åè®®å¤„ç†å®Œæˆ (è¯¦è§ /tmp/license-output.log)"

# å®‰è£… Android SDK ç»„ä»¶
RUN ${ANDROID_HOME}/cmdline-tools/latest/bin/sdkmanager --update \
    && ${ANDROID_HOME}/cmdline-tools/latest/bin/sdkmanager \
        "platform-tools" \
        "build-tools;${BUILD_TOOLS_VERSION}" \
        "platforms;${PLATFORM_VERSION}"

# =============================================================================
# è®¾ç½®å·¥ä½œç›®å½•
# =============================================================================
WORKDIR /app

# åˆ›å»ºè¾“å‡ºç›®å½•
RUN mkdir -p /app/output

# è®¾ç½® Kotlin ç‰ˆæœ¬ç¯å¢ƒå˜é‡ (ç”¨äºè¿è¡Œæ—¶è„šæœ¬)
ENV KOTLIN_VERSION=${KOTLIN_VERSION}

# æ³¨æ„: æºä»£ç ä¸å†å¤åˆ¶åˆ°é•œåƒä¸­ï¼Œè€Œæ˜¯åœ¨è¿è¡Œæ—¶é€šè¿‡å·æŒ‚è½½
# è¿™ç¡®ä¿æ¯æ¬¡æ„å»ºéƒ½ä½¿ç”¨æœ€æ–°çš„æºä»£ç 

# =============================================================================
# æ„å»ºå…¥å£è„šæœ¬
# =============================================================================
COPY <<'EOF' /app/docker-build-apk.sh
#!/bin/bash
# =============================================================================
# Docker å®¹å™¨å†… APK æ„å»ºè„šæœ¬
# =============================================================================

MODE=${1:-debug}

echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
echo "â•‘      ğŸ³ Docker APK æ„å»ºç¯å¢ƒ                                  â•‘"
echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo ""
echo "ğŸ“¦ æ„å»ºæ¨¡å¼: $MODE"
echo "ğŸ“ Android SDK: $ANDROID_HOME"
echo "â˜• Java: $(java --version 2>&1 | head -1)"
echo "ğŸ“— Node.js: $(node --version)"
echo ""

# =============================================================================
# å¤åˆ¶æºä»£ç  (ä»æŒ‚è½½çš„å·å¤åˆ¶åˆ°å·¥ä½œç›®å½•ï¼Œç¡®ä¿ä½¿ç”¨æœ€æ–°ä»£ç )
# =============================================================================
SOURCE_MOUNT="/app/source"
if [ -d "$SOURCE_MOUNT" ]; then
    echo "ğŸ“‚ å¤åˆ¶æœ€æ–°æºä»£ç ..."
    # å¤åˆ¶æºä»£ç æ–‡ä»¶ (æ’é™¤ node_modules, build, android æ„å»ºäº§ç‰©)
    rsync -a --exclude='node_modules' --exclude='build' --exclude='dist' \
          --exclude='android/.gradle' --exclude='android/app/build' --exclude='android/build' \
          --exclude='.git' --exclude='output' --exclude='*.apk' \
          "$SOURCE_MOUNT/" /app/
    if [ $? -ne 0 ]; then
        echo "âŒ æºä»£ç å¤åˆ¶å¤±è´¥ï¼"
        exit 1
    fi
    echo "âœ… æºä»£ç å·²å¤åˆ¶"
    
    # =============================================================================
    # æ£€æŸ¥ eov é…ç½®æ–‡ä»¶
    # æ³¨æ„: eov æ–‡ä»¶é€šè¿‡ Docker å·æŒ‚è½½åˆ° /app/eov
    # inject-eov.js ä¼šè‡ªåŠ¨åœ¨é¡¹ç›®ç›®å½•æŸ¥æ‰¾æ­¤æ–‡ä»¶
    # =============================================================================
    if [ -f "/app/eov" ]; then
        echo "âœ… å·²æŒ‚è½½ eov é…ç½®æ–‡ä»¶"
    else
        echo "âš ï¸  æœªæŒ‚è½½ eov é…ç½®æ–‡ä»¶ï¼Œå°†ä½¿ç”¨é¡¹ç›®å†…ç½®çš„é»˜è®¤é…ç½®"
    fi
else
    echo "âš ï¸  æœªæ‰¾åˆ°æºä»£ç æŒ‚è½½ç›®å½• $SOURCE_MOUNTï¼Œä½¿ç”¨é•œåƒå†…ç½®ä»£ç "
fi
echo ""

# =============================================================================
# å®‰è£…ä¾èµ– (æºä»£ç é€šè¿‡å·æŒ‚è½½ï¼Œæ¯æ¬¡æ„å»ºéƒ½éœ€è¦å®‰è£…ä¾èµ–)
# =============================================================================
echo "ğŸ“¦ å®‰è£…ä¾èµ–..."
npm install --quiet
if [ $? -ne 0 ]; then
    echo "âŒ npm install å¤±è´¥ï¼"
    exit 1
fi

# å®‰è£… Capacitor ä¾èµ–
npm install @capacitor/core @capacitor/cli @capacitor/android --quiet
if [ $? -ne 0 ]; then
    echo "âŒ Capacitor ä¾èµ–å®‰è£…å¤±è´¥ï¼"
    exit 1
fi
echo "âœ… ä¾èµ–å®‰è£…å®Œæˆ"
echo ""

# æ³¨å…¥ EOV é…ç½® (å¦‚æœè„šæœ¬å­˜åœ¨)
if [ -f "scripts/inject-eov.js" ]; then
    echo "ğŸ“ æ³¨å…¥ EOV é…ç½®..."
    node scripts/inject-eov.js || true
    echo ""
fi

# æ£€æŸ¥æ˜¯å¦éœ€è¦åˆå§‹åŒ– Capacitor
if [ ! -f "capacitor.config.ts" ] && [ ! -f "capacitor.config.json" ]; then
    echo "ğŸ“ åˆå§‹åŒ– Capacitor..."
    npx cap init "è§†é¢‘æ’­æ”¾å™¨" "com.videoapp.player" --web-dir=dist
fi

# æ£€æŸ¥æ˜¯å¦æ·»åŠ äº† Android å¹³å°
if [ ! -d "android" ]; then
    echo "ğŸ“² æ·»åŠ  Android å¹³å°..."
    npx cap add android
    if [ $? -ne 0 ]; then
        echo "âŒ æ·»åŠ  Android å¹³å°å¤±è´¥ï¼"
        exit 1
    fi
fi

# =============================================================================
# ä¿®å¤ Kotlin stdlib é‡å¤ç±»å†²çª
# é—®é¢˜: kotlin-stdlib 1.8+ å·²åŒ…å« jdk7/jdk8 ç±»ï¼Œä½†æŸäº›ä¾èµ–å¯èƒ½å¼•å…¥æ—§ç‰ˆæœ¬çš„
#       kotlin-stdlib-jdk7 å’Œ kotlin-stdlib-jdk8ï¼Œå¯¼è‡´ç±»é‡å¤é”™è¯¯
# è§£å†³: åœ¨ build.gradle ä¸­æ·»åŠ ä¾èµ–è§£æç­–ç•¥ï¼Œå¼ºåˆ¶ä½¿ç”¨ç»Ÿä¸€ç‰ˆæœ¬
# =============================================================================
KOTLIN_VERSION=${KOTLIN_VERSION:-1.8.22}
echo ""
echo "ğŸ”§ ä¿®å¤ Kotlin ä¾èµ–å†²çª (Kotlin $KOTLIN_VERSION)..."
if [ -f "android/build.gradle" ]; then
    # ä½¿ç”¨å”¯ä¸€æ ‡è®°æ£€æµ‹æ˜¯å¦å·²ç»æ·»åŠ äº†ä¿®å¤
    KOTLIN_FIX_MARKER="VIDEOAPP_KOTLIN_STDLIB_FIX_APPLIED"
    if ! grep -q "$KOTLIN_FIX_MARKER" "android/build.gradle"; then
        # è¿½åŠ  Kotlin ç‰ˆæœ¬è§£æç­–ç•¥åˆ°æ–‡ä»¶æœ«å°¾
        cat >> "android/build.gradle" << KOTLIN_FIX

// $KOTLIN_FIX_MARKER
// =============================================================================
// ä¿®å¤ Kotlin stdlib é‡å¤ç±»å†²çª
// ä» Kotlin 1.8 å¼€å§‹ï¼Œkotlin-stdlib-jdk7 å’Œ kotlin-stdlib-jdk8 å·²åˆå¹¶åˆ° kotlin-stdlib
// è¿™ä¸ªé…ç½®ç¡®ä¿æ‰€æœ‰æ¨¡å—ä½¿ç”¨ç»Ÿä¸€çš„ Kotlin ç‰ˆæœ¬ï¼Œé¿å…ç±»é‡å¤é”™è¯¯
// =============================================================================
subprojects {
    afterEvaluate {
        configurations.all {
            resolutionStrategy.eachDependency { details ->
                if (details.requested.group == 'org.jetbrains.kotlin') {
                    details.useVersion '$KOTLIN_VERSION'
                }
            }
            // æ’é™¤æ—§ç‰ˆæœ¬çš„ kotlin-stdlib-jdk7 å’Œ kotlin-stdlib-jdk8
            exclude group: 'org.jetbrains.kotlin', module: 'kotlin-stdlib-jdk7'
            exclude group: 'org.jetbrains.kotlin', module: 'kotlin-stdlib-jdk8'
        }
    }
}
KOTLIN_FIX
        echo "âœ… Kotlin ä¾èµ–å†²çªä¿®å¤å·²åº”ç”¨"
    else
        echo "âœ… Kotlin ä¾èµ–å†²çªä¿®å¤å·²å­˜åœ¨"
    fi
else
    echo "âš ï¸  æœªæ‰¾åˆ° android/build.gradleï¼Œè·³è¿‡ Kotlin ä¿®å¤"
fi

# =============================================================================
# ä¿®å¤ APK å®‰è£…è§£æå¤±è´¥é—®é¢˜
# é—®é¢˜: APK å®‰è£…æ—¶å¯èƒ½ä¼šå‡ºç°"è§£æå¤±è´¥"é”™è¯¯
# åŸå› : 1. minSdkVersion è®¾ç½®è¿‡é«˜æˆ–è¿‡ä½
#       2. targetSdkVersion ä¸è®¾å¤‡ä¸å…¼å®¹
#       3. AndroidManifest.xml é…ç½®é—®é¢˜
# è§£å†³: ç¡®ä¿ app/build.gradle æœ‰æ­£ç¡®çš„ SDK ç‰ˆæœ¬é…ç½®
# =============================================================================
echo ""
echo "ğŸ”§ é…ç½® Android SDK ç‰ˆæœ¬ä»¥ç¡®ä¿ APK å…¼å®¹æ€§..."
if [ -f "android/app/build.gradle" ]; then
    APK_FIX_MARKER="VIDEOAPP_APK_COMPAT_FIX_APPLIED"
    if ! grep -q "$APK_FIX_MARKER" "android/app/build.gradle"; then
        # æ·»åŠ å…¼å®¹æ€§ä¿®å¤åˆ° app/build.gradle
        cat >> "android/app/build.gradle" << APK_FIX

// $APK_FIX_MARKER
// =============================================================================
// ä¿®å¤ APK å®‰è£…è§£æå¤±è´¥é—®é¢˜
// ç¡®ä¿ APK å¯ä»¥åœ¨å¤§å¤šæ•° Android è®¾å¤‡ä¸Šå®‰è£…
// =============================================================================
android {
    defaultConfig {
        // æœ€ä½æ”¯æŒ Android 6.0 (API 23)ï¼Œç¡®ä¿å¹¿æ³›å…¼å®¹æ€§
        minSdkVersion 23
        // ç›®æ ‡ Android API 35 (æ»¡è¶³ AndroidX ä¾èµ–è¦æ±‚)
        targetSdkVersion 35
        // ç‰ˆæœ¬å·
        versionCode 1
        versionName "1.0.0"
    }
    
    // ç¡®ä¿ APK æ­£ç¡®ç­¾å
    signingConfigs {
        debug {
            // ä½¿ç”¨è°ƒè¯•ç­¾å
        }
    }
    
    buildTypes {
        debug {
            signingConfig signingConfigs.debug
            debuggable true
        }
        release {
            signingConfig signingConfigs.debug // ä¸´æ—¶ä½¿ç”¨è°ƒè¯•ç­¾åï¼Œç”Ÿäº§ç¯å¢ƒåº”ä½¿ç”¨æ­£å¼ç­¾å
            minifyEnabled false
            proguardFiles getDefaultProguardFile('proguard-android-optimize.txt'), 'proguard-rules.pro'
        }
    }
    
    // è§£å†³ lint é”™è¯¯é˜»æ­¢æ„å»º
    lintOptions {
        checkReleaseBuilds false
        abortOnError false
    }
}
APK_FIX
        echo "âœ… APK å…¼å®¹æ€§ä¿®å¤å·²åº”ç”¨"
    else
        echo "âœ… APK å…¼å®¹æ€§ä¿®å¤å·²å­˜åœ¨"
    fi
else
    echo "âš ï¸  æœªæ‰¾åˆ° android/app/build.gradleï¼Œè·³è¿‡ APK å…¼å®¹æ€§ä¿®å¤"
fi

# =============================================================================
# ä¿®å¤ AndroidManifest.xml é…ç½®é—®é¢˜
# ç¡®ä¿ exported å±æ€§æ­£ç¡®è®¾ç½® (Android 12+ è¦æ±‚)
# =============================================================================
echo ""
echo "ğŸ”§ æ£€æŸ¥ AndroidManifest.xml é…ç½®..."
MANIFEST_PATH="android/app/src/main/AndroidManifest.xml"
if [ -f "$MANIFEST_PATH" ]; then
    # æ£€æŸ¥æ˜¯å¦ç¼ºå°‘ android:exported å±æ€§ (Android 12+ è¦æ±‚)
    # æ³¨æ„: Capacitor ç”Ÿæˆçš„ AndroidManifest.xml é€šå¸¸å·²ç»åŒ…å«æ­¤å±æ€§
    # åªæœ‰åœ¨ç¡®å®ç¼ºå°‘æ—¶æ‰æ·»åŠ ï¼Œé¿å…é‡å¤
    if grep -q '<activity.*android:name=".MainActivity"' "$MANIFEST_PATH" && ! grep -q 'android:exported=' "$MANIFEST_PATH"; then
        echo "   è­¦å‘Š: AndroidManifest.xml ç¼ºå°‘ android:exported å±æ€§"
        echo "   è¯·æ‰‹åŠ¨æ£€æŸ¥å¹¶æ·»åŠ  android:exported=\"true\" åˆ° MainActivity"
    fi
    echo "âœ… AndroidManifest.xml é…ç½®æ£€æŸ¥å®Œæˆ"
else
    echo "âš ï¸  æœªæ‰¾åˆ° AndroidManifest.xml"
fi

# =============================================================================
# æ£€æŸ¥ variables.gradle SDK ç‰ˆæœ¬
# ç¡®ä¿ä½¿ç”¨ Android SDK 35 ä»¥æ»¡è¶³ AndroidX ä¾èµ–è¦æ±‚
# =============================================================================
echo ""
echo "ğŸ”§ æ£€æŸ¥ variables.gradle SDK ç‰ˆæœ¬..."
VARIABLES_PATH="android/variables.gradle"
if [ -f "$VARIABLES_PATH" ]; then
    # æ˜¾ç¤ºå½“å‰ SDK ç‰ˆæœ¬é…ç½®
    echo "   å½“å‰ SDK ç‰ˆæœ¬é…ç½®:"
    grep -E 'compileSdkVersion|targetSdkVersion|minSdkVersion' "$VARIABLES_PATH" | sed 's/^/   /'
    echo "âœ… variables.gradle SDK ç‰ˆæœ¬æ£€æŸ¥å®Œæˆ (ä½¿ç”¨ Android SDK 35)"
fi

# æ„å»º Web åº”ç”¨
echo ""
echo "ğŸ”¨ æ„å»º Web åº”ç”¨..."
npm run build

if [ $? -ne 0 ]; then
    echo "âŒ Web æ„å»ºå¤±è´¥ï¼"
    exit 1
fi

# åŒæ­¥ Capacitor
echo ""
echo "ğŸ“² åŒæ­¥åˆ° Android..."
npx cap sync android

if [ $? -ne 0 ]; then
    echo "âŒ Capacitor åŒæ­¥å¤±è´¥ï¼"
    exit 1
fi

# æ„å»º APK
echo ""
echo "ğŸ“¦ æ„å»º APK..."
cd android

# æ¸…ç†ä¹‹å‰çš„æ„å»º (å¿½ç•¥é”™è¯¯ï¼Œå› ä¸ºå¯èƒ½æ˜¯é¦–æ¬¡æ„å»º)
./gradlew clean 2>&1 || true

if [ "$MODE" = "release" ]; then
    echo "   æ¨¡å¼: Release (ç­¾åç‰ˆæœ¬)"
    ./gradlew --no-daemon assembleRelease
    APK_PATH="app/build/outputs/apk/release/app-release.apk"
    APK_UNSIGNED_PATH="app/build/outputs/apk/release/app-release-unsigned.apk"
else
    echo "   æ¨¡å¼: Debug (è°ƒè¯•ç‰ˆæœ¬)"
    ./gradlew --no-daemon assembleDebug
    APK_PATH="app/build/outputs/apk/debug/app-debug.apk"
fi

BUILD_RESULT=$?
cd ..

if [ $BUILD_RESULT -eq 0 ]; then
    echo ""
    echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
    echo "âœ… APK æ‰“åŒ…æˆåŠŸï¼"
    echo ""
    
    # å¤åˆ¶ APK åˆ°è¾“å‡ºç›®å½•
    FULL_APK_PATH="android/$APK_PATH"
    if [ -f "$FULL_APK_PATH" ]; then
        cp "$FULL_APK_PATH" /app/output/
        SIZE=$(du -h "$FULL_APK_PATH" | cut -f1)
        echo "ğŸ“ APK å·²å¤åˆ¶åˆ°: /app/output/$(basename $APK_PATH)"
        echo "ğŸ“Š APK å¤§å°: $SIZE"
    elif [ -f "android/$APK_UNSIGNED_PATH" ]; then
        cp "android/$APK_UNSIGNED_PATH" /app/output/
        SIZE=$(du -h "android/$APK_UNSIGNED_PATH" | cut -f1)
        echo "ğŸ“ APK å·²å¤åˆ¶åˆ°: /app/output/$(basename $APK_UNSIGNED_PATH)"
        echo "ğŸ“Š APK å¤§å°: $SIZE"
        echo ""
        echo "âš ï¸  æ³¨æ„: è¿™æ˜¯æœªç­¾åçš„ APKï¼Œéœ€è¦ç­¾ååæ‰èƒ½å‘å¸ƒ"
    fi
    
    echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
else
    echo ""
    echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
    echo "âŒ APK æ‰“åŒ…å¤±è´¥ï¼"
    echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
    exit 1
fi
EOF

RUN chmod +x /app/docker-build-apk.sh

# =============================================================================
# é»˜è®¤å…¥å£ç‚¹
# =============================================================================
ENTRYPOINT ["/app/docker-build-apk.sh"]
CMD ["debug"]
